

üîí REPLIT HARDENING PROMPT

Close Enterprise Production Gaps ‚Äî NO NEW FEATURES

‚∏ª

üî¥ OPERATING MODE (CRITICAL)

You are NOT adding features.
You are NOT improving UI.
You are NOT changing architecture.

You are performing Enterprise Production Hardening ONLY.

If you add:
	‚Ä¢	new pages
	‚Ä¢	new use-cases
	‚Ä¢	new AI logic
	‚Ä¢	new UI polish

üëâ THE TASK IS FAILED.

‚∏ª

üéØ OBJECTIVE

Close the following three critical Enterprise production gaps in the existing Enterprise AI Layer platform:
	1.	Audit must be non-bypassable
	2.	Capabilities must be enforced server-side
	3.	Action execution must be technically impossible (not just disabled)

‚∏ª

1Ô∏è‚É£ GAP #1 ‚Äî IMMUTABLE AUDIT (NON-BYPASSABLE)

CURRENT RISK

Audit exists, but it is not proven that every write path is audited.

REQUIRED FIX (MANDATORY)

You must guarantee and prove:

There is NO code path that mutates state without emitting an audit event.

REQUIRED IMPLEMENTATION
	1.	Introduce a central write-guard layer:
	‚Ä¢	All state-changing operations MUST go through it
	‚Ä¢	No direct DB writes allowed outside it
	2.	The guard must:
	‚Ä¢	Emit an audit event BEFORE commit
	‚Ä¢	Abort transaction if audit logging fails
	3.	Enforce this by:
	‚Ä¢	Code structure
	‚Ä¢	Not by developer convention
	4.	Add explicit comment + documentation:

// SECURITY GUARANTEE:
// No state mutation can occur without an audit record.



REQUIRED PROOF
	‚Ä¢	Show a code example of:
	‚Ä¢	a blocked write when audit fails
	‚Ä¢	Add a unit test asserting:
	‚Ä¢	write ‚Üí audit ‚Üí commit
	‚Ä¢	audit failure ‚Üí rollback

‚∏ª

2Ô∏è‚É£ GAP #2 ‚Äî CAPABILITY ENFORCEMENT (BACKEND, NOT UI)

CURRENT RISK

Capabilities appear to be enforced in UI, but not proven server-side.

REQUIRED FIX (MANDATORY)

Capabilities MUST be enforced at the API and service layer, regardless of UI state.

REQUIRED IMPLEMENTATION
	1.	Every use-case execution path must:
	‚Ä¢	Check required capabilities from Capability Discovery Engine
	‚Ä¢	Reject request server-side if missing
	2.	Add a capability gate:

requireCapability("inventory_read")


	3.	Missing capability must:
	‚Ä¢	Reject with HTTP 403
	‚Ä¢	Emit audit event:

CAPABILITY_DENIED


	4.	UI state must NOT be trusted.

REQUIRED PROOF
	‚Ä¢	Show backend code rejecting a request even if UI calls it directly
	‚Ä¢	Add test:
	‚Ä¢	capability missing ‚Üí API fails ‚Üí audit logged

‚∏ª

3Ô∏è‚É£ GAP #3 ‚Äî ACTION EXECUTION MUST BE IMPOSSIBLE

CURRENT RISK

Actions are ‚Äúdisabled‚Äù, but not proven impossible.

REQUIRED FIX (MANDATORY)

No execution must be possible even if someone bypasses UI or calls API directly.

REQUIRED IMPLEMENTATION
	1.	Introduce a hard execution lock:

EXECUTION_MODE = DRAFT_ONLY

This must be:
	‚Ä¢	Hardcoded in production
	‚Ä¢	NOT configurable via UI
	‚Ä¢	NOT overrideable at runtime

	2.	Remove or block:
	‚Ä¢	Any POST/PUT endpoint capable of committing changes
	‚Ä¢	Any credential with write/commit privileges
	3.	Backend must throw:

EXECUTION_FORBIDDEN_BY_DESIGN


	4.	Log audit event:

EXECUTION_ATTEMPT_BLOCKED



REQUIRED PROOF
	‚Ä¢	Attempted execution returns error
	‚Ä¢	Audit log records the attempt
	‚Ä¢	No DB mutation occurs

‚∏ª

üö´ EXPLICITLY FORBIDDEN
	‚Ä¢	Adding feature flags to UI only
	‚Ä¢	‚ÄúDisabled‚Äù buttons without backend enforcement
	‚Ä¢	Comments without enforcement
	‚Ä¢	Trusting client state
	‚Ä¢	Soft rules or conventions

‚∏ª

‚úÖ REQUIRED DELIVERABLES

You must return:
	1.	Code diffs showing:
	‚Ä¢	audit write-guard
	‚Ä¢	capability gate
	‚Ä¢	execution hard lock
	2.	Unit tests proving:
	‚Ä¢	audit non-bypassable
	‚Ä¢	capability enforcement
	‚Ä¢	execution impossible
	3.	Short technical note (max 1 page):
	‚Ä¢	Explaining why execution is impossible by design
	‚Ä¢	Suitable for CISO review

‚∏ª

‚ùå FAILURE CONDITIONS (ANY = FAIL)
	‚Ä¢	Any state change without audit
	‚Ä¢	Capability enforced only in UI
	‚Ä¢	Execution blocked by config instead of design
	‚Ä¢	No tests proving enforcement

‚∏ª

üü¢ SUCCESS DEFINITION

The task is successful ONLY if:

Even a malicious internal API call
Cannot execute an action
Cannot bypass audit
Cannot bypass capability checks

‚∏ª

üîö END OF HARDENING PROMPT

‚∏ª
