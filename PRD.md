# ูุซููุฉ ูุชุทูุจุงุช ุงูููุชุฌ (PRD)
## ููุตุฉ Atlas - ุทุจูุฉ ุงูุชูุงูู ุงููุคุณุณู

---

## ูก. ููุฏูุฉ ุงูููุชุฌ

### ุงูุฑุคูุฉ
**Atlas** ูู ููุตุฉ ุชูุงูู ูุคุณุณูุฉ ูุชูุงููุฉ ุชุฑุจุท ุจูู ุฃูุธูุฉ ุงููุฎุฒูู ูุชูุฏู ุชูุตูุงุช ุฐููุฉ ูุน ุถูุงู ุงูููุงููุฉ ุงูุจุดุฑูุฉ ุนูู ุฌููุน ุงููุฑุงุฑุงุช.

### ุงูุดุนุงุฑ
**ููุตุฉ ุงูุฐูุงุก ุงููุคุณุณู** - Enterprise AI Layer (EAL)

### ุงููููุฉ ุงูุจุตุฑูุฉ
| ุงูุนูุตุฑ | ุงููููุฉ |
|--------|--------|
| **ุงูุฃููููุฉ** | CircleDot |
| **ุงูููู ุงูุฃุณุงุณู** | ุฃุฒุฑู ูุฎุถุฑ ูุงุฏุฆ (HSL 192ยฐ 45% 42%) |
| **ุงููุธูุฑ ุงูุงูุชุฑุงุถู** | ูุงุชุญ ูุน ุฌูุงููุฉ ุจูุถุงุก ูุธููุฉ |
| **ุงููุบุฉ ุงูุงูุชุฑุงุถูุฉ** | ุงูุนุฑุจูุฉ (RTL) ูุน ุฅููุงููุฉ ุงูุชุจุฏูู ููุฅูุฌููุฒูุฉ |

### ุงููุจุงุฏุฆ ุงูุฃุณุงุณูุฉ
- **REST ุฃููุงู**: ููุชุฑุถ ุฃู ุงูุนููุงุก ูููุฑูู REST APIs ููุทุ ุงูุชูุงููุงุช ุงูุฎุงุตุฉ ุจู ERP ุงุฎุชูุงุฑูุฉ
- **ุงูุชุดุบูู ูุงูุชูุนูู**: ุฅุนุฏุงุฏ ุจุฏูู ููุฏ ุนุจุฑ ุงููุงุฌูุฉ ูุงูุฅุนุฏุงุฏุงุช
- **ุงูุฐูุงุก ุงูุงุตุทูุงุนู ููุตู ููุท**: ุงูุฐูุงุก ุงูุงุตุทูุงุนู ูููุฏ ุชูุตูุงุช ููู ูุง ูููุฐ ุชููุงุฆูุงู ุฃุจุฏุงู
- **ุงูุฅูุณุงู ูู ุงูุญููุฉ**: ุฌููุน ุงููุฑุงุฑุงุช ุชุชุทูุจ ููุงููุฉ ุตุฑูุญุฉ ูุจู ุงูุชูููุฐ

---

## ูข. ุงูุดุฑุงุฆุญ ุงููุณุชูุฏูุฉ

| ุงูุดุฑูุญุฉ | ุงููุตู | ุญุฌู ุงูุดุฑูุฉ | ูููุฐุฌ ุงูุชุญููู |
|---------|-------|------------|---------------|
| **ุงููุคุณุณุงุช** (Enterprise) | ุงูุดุฑูุงุช ุงููุจุฑู ุงูุชู ุชุญุชุงุฌ ุฏุนู ูุฎุตุต ูุชูุงูู ูุนูู | +500 ููุธู | ุงุฌุชูุงุน ูุน ูุฑูู ุงููุจูุนุงุช |
| **ุงูุดุฑูุงุช ุงูุตุบูุฑุฉ ูุงููุชูุณุทุฉ** (SMB) | ุงูุดุฑูุงุช ุงูุชู ุชุจุญุซ ุนู ุญููู ุฌุงูุฒุฉ ุจุชูุนูู ุฐุงุชู | ุฃูู ูู 500 ููุธู | ุฏูุน ุฐุงุชู ุนุจุฑ ูููุตุงุฑ |

---

## ูฃ. ุฑุญูุงุช ุงููุณุชุฎุฏู

### ูฃ.ูก ุฑุญูุฉ ุงููุคุณุณุงุช (Enterprise Journey)

```
โโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโโ
โ  ุงูุชุณุฌูู   โ โ โ  ุงุฎุชูุงุฑ ูุคุณุณุฉ   โ โ โ ูุชุฑุฉ ุชุฌุฑูุจูุฉ   โ โ โ ุงูุชูุงุก ุงููุชุฑุฉ  โ โ โ  ุญุฌุฒ ุงุฌุชูุงุน    โ
โ  OIDC      โ    โ  + ุญุงูุฉ ุงุณุชุฎุฏุงู โ    โ    7 ุฃูุงู      โ    โ  ุดุงุดุฉ ุฎุงุตุฉ     โ    โ  ูุน ุงููุจูุนุงุช    โ
โโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโโ
```

**ุชูุงุตูู ุงูุฑุญูุฉ:**
1. ุชุณุฌูู ุงูุฏุฎูู ุนุจุฑ Google/GitHub/ุงูุจุฑูุฏ ุงูุฅููุชุฑููู
2. ุงุฎุชูุงุฑ "ูุคุณุณุฉ" ูููุน ุงูุดุฑูุฉ
3. ุงุฎุชูุงุฑ ุญุงูุฉ ุงูุงุณุชุฎุฏุงู (ุฅุฏุงุฑุฉ ุงููุฎุฒูู ูุชุงุญุฉุ ุงูุจููุฉ ููููุฉ)
4. ุจุฏุก ุงููุชุฑุฉ ุงูุชุฌุฑูุจูุฉ (7 ุฃูุงู)
5. ุนูุฏ ุงูุงูุชูุงุก: ุดุงุดุฉ ุฎุงุตุฉ ุจุญุฌุฒ ุงุฌุชูุงุน ูุน ูุฑูู ุงููุจูุนุงุช

### ูฃ.ูข ุฑุญูุฉ ุงูุดุฑูุงุช ุงูุตุบูุฑุฉ (SMB Journey)

```
โโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโโ
โ  ุงูุชุณุฌูู   โ โ โ  ุงุฎุชูุงุฑ SMB     โ โ โ ูุชุฑุฉ ุชุฌุฑูุจูุฉ   โ โ โ ุงูุชูุงุก ุงููุชุฑุฉ  โ โ โ  ุงูุฏูุน ุนุจุฑ     โ
โ  OIDC      โ    โ  + ุญุงูุฉ ุงุณุชุฎุฏุงู โ    โ    7 ุฃูุงู      โ    โ  ุงุฎุชูุงุฑ ุงูุฎุทุฉ  โ    โ  ูููุตุงุฑ        โ
โโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโโ
```

**ุชูุงุตูู ุงูุฑุญูุฉ:**
1. ุชุณุฌูู ุงูุฏุฎูู ุนุจุฑ Google/GitHub/ุงูุจุฑูุฏ ุงูุฅููุชุฑููู
2. ุงุฎุชูุงุฑ "ุดุฑูุฉ ุตุบูุฑุฉ ุฃู ูุชูุณุทุฉ" ูููุน ุงูุดุฑูุฉ
3. ุงุฎุชูุงุฑ ุญุงูุฉ ุงูุงุณุชุฎุฏุงู (ุฅุฏุงุฑุฉ ุงููุฎุฒูู ูุชุงุญุฉุ ุงูุจููุฉ ููููุฉ)
4. ุจุฏุก ุงููุชุฑุฉ ุงูุชุฌุฑูุจูุฉ (7 ุฃูุงู)
5. ุนูุฏ ุงูุงูุชูุงุก: ุนุฑุถ ุฎุทุท ุงูุงุดุชุฑุงู ูุน ุฎูุงุฑุงุช ุงูุฏูุน (ูุฏู/ููุฒุง/ูุงุณุชุฑูุงุฑุฏ)

---

## ูค. ุฅุฏุงุฑุฉ ุงููุชุฑุฉ ุงูุชุฌุฑูุจูุฉ

### ูค.ูก ููุงุตูุงุช ุงููุชุฑุฉ ุงูุชุฌุฑูุจูุฉ
| ุงูุนูุตุฑ | ุงููููุฉ |
|--------|--------|
| **ุงููุฏุฉ** | 7 ุฃูุงู ูุฌุงููุฉ |
| **ูุชุงุญุฉ ูู** | ุงููุคุณุณุงุช ูุงูุดุฑูุงุช ุงูุตุบูุฑุฉ |
| **ุงูููุฒุงุช ุงููุชุงุญุฉ** | ุฌููุน ููุฒุงุช ุงูุฎุทุฉ ุงููุฎุชุงุฑุฉ |
| **ูุง ูุชุทูุจ** | ุจุทุงูุฉ ุงุฆุชูุงู ููุจุฏุก |

### ูค.ูข ูุงูุชุฉ ุงูุนุฏ ุงูุชูุงุฒูู (Trial Banner)

| ุงูุฃูุงู ุงููุชุจููุฉ | ุงูููู | ุงูุฑุณุงูุฉ ุงูุนุฑุจูุฉ | ุงูุฑุณุงูุฉ ุงูุฅูุฌููุฒูุฉ |
|----------------|-------|-----------------|-------------------|
| 5-7 ุฃูุงู | ๐ต ุฃุฒุฑู | "ุชุจูู X ุฃูุงู ูู ูุชุฑุชู ุงูุชุฌุฑูุจูุฉ" | "X days left in your trial" |
| 2-4 ุฃูุงู | ๐ก ุฃุตูุฑ | "ุชุจูู X ุฃูุงู - ูู ุจุงูุชุฑููุฉ ุงูุขู" | "X days left - Upgrade now" |
| ููู ูุงุญุฏ | ๐ด ุฃุญูุฑ | "ููุชูู ุงุดุชุฑุงูู ุบุฏุงู!" | "Your trial ends tomorrow!" |

**ุงููููู:** `client/src/components/trial-banner.tsx`

### ูค.ูฃ ุดุงุดุงุช ุงูุชูุงุก ุงููุชุฑุฉ ุงูุชุฌุฑูุจูุฉ

#### ูููุคุณุณุงุช (Enterprise)
- ุนููุงู: "ุงูุชูุช ูุชุฑุชู ุงูุชุฌุฑูุจูุฉ"
- ุฑุณุงูุฉ: ุฏุนูุฉ ููุชูุงุตู ูุน ูุฑูู ุงููุจูุนุงุช
- ุฒุฑ CTA: "ุงุญุฌุฒ ุงุฌุชูุงุนุงู ูุน ูุฑูููุง"
- ุฃููููุฉ: Calendar

#### ููุดุฑูุงุช ุงูุตุบูุฑุฉ (SMB)
- ุนููุงู: "ุงูุชูุช ูุชุฑุชู ุงูุชุฌุฑูุจูุฉ"
- ุฑุณุงูุฉ: ุงุฎุชุฑ ุงูุฎุทุฉ ุงูููุงุณุจุฉ ูุงุณุชูุฑุงุฑ ุงููุตูู
- ุนุฑุถ: ุจุทุงูุงุช ุงูุฎุทุท ุงูุซูุงุซ (ุฃุณุงุณูุฉุ ุงุญุชุฑุงููุฉุ ูุคุณุณูุฉ)
- ุฒุฑ CTA: "ุงุดุชุฑู ุงูุขู" ููู ุฎุทุฉ
- ูููุฐุฌ ุงูุฏูุน: ูุฏู ุฃู ููุฒุง/ูุงุณุชุฑูุงุฑุฏ

**ุงููููู:** `client/src/components/trial-expired-screen.tsx`

---

## ูฅ. ูุธุงู ุงูุงุดุชุฑุงูุงุช

### ูฅ.ูก ุงูุฎุทุท ุงููุชุงุญุฉ

| ุงูุฎุทุฉ | ุงูุณุนุฑ ุงูุดูุฑู | ุงูููุตูุงุช | ุงูุณุฌูุงุช | ุงูุฏุนู |
|-------|-------------|----------|---------|-------|
| **ุงูุฃุณุงุณูุฉ** (Basic) | 299 ุฑ.ุณ | 1 | 1,000 | ุจุฑูุฏ ุฅููุชุฑููู |
| **ุงูุงุญุชุฑุงููุฉ** (Professional) | 799 ุฑ.ุณ | 5 | 10,000 | ููู ูุชุฎุตุต |
| **ุงููุคุณุณูุฉ** (Enterprise) | 1,999 ุฑ.ุณ | ุบูุฑ ูุญุฏูุฏ | ุบูุฑ ูุญุฏูุฏ | ูุฎุตุต + SLA |

### ูฅ.ูข ุญุงูุงุช ุงูุงุดุชุฑุงู

| ุงูุญุงูุฉ | ุงููุตู | ุงููุตูู ููููุตุฉ |
|--------|-------|---------------|
| `trial` | ูุชุฑุฉ ุชุฌุฑูุจูุฉ ูุดุทุฉ | โ ูุงูู |
| `active` | ุงุดุชุฑุงู ูุฏููุน ูุดุท | โ ูุงูู |
| `past_due` | ูุชุฃุฎุฑ ูู ุงูุณุฏุงุฏ | โ๏ธ ูุญุฏูุฏ |
| `cancelled` | ููุบู ูู ูุจู ุงููุณุชุฎุฏู | โ ูุฑุงุกุฉ ููุท |
| `expired` | ููุชูู ุงูุตูุงุญูุฉ | โ ููููุน |

### ูฅ.ูฃ ุฌุฏูู ูุงุนุฏุฉ ุงูุจูุงูุงุช

```typescript
// subscription_plans
id: uuid
name: string              // "basic" | "professional" | "enterprise"
displayName: string       // "ุงูุฃุณุงุณูุฉ" | "ุงูุงุญุชุฑุงููุฉ" | "ุงููุคุณุณูุฉ"
price: integer           // ุจุงููููุงุช (29900 = 299 ุฑ.ุณ)
currency: string         // "SAR"
features: json           // ูุงุฆูุฉ ุงูููุฒุงุช

// subscriptions
id: uuid
tenantId: uuid
planId: uuid
status: string
trialEndsAt: timestamp
currentPeriodStart: timestamp
currentPeriodEnd: timestamp
```

---

## ูฆ. ุงูุชูุงูู ูุน ุจูุงุจุฉ ุงูุฏูุน (ูููุตุงุฑ)

### ูฆ.ูก ุทุฑู ุงูุฏูุน ุงููุฏุนููุฉ

| ุทุฑููุฉ ุงูุฏูุน | ุงููุตู | ุงูุฃููููุฉ |
|-------------|-------|----------|
| **ูุฏู** (Mada) | ุงูุจุทุงูุงุช ุงูุจูููุฉ ุงูุณุนูุฏูุฉ | ๐ณ |
| **ููุฒุง** (Visa) | ุงูุจุทุงูุงุช ุงูุงุฆุชูุงููุฉ ุงูุฏูููุฉ | ๐ณ |
| **ูุงุณุชุฑูุงุฑุฏ** (Mastercard) | ุงูุจุทุงูุงุช ุงูุงุฆุชูุงููุฉ ุงูุฏูููุฉ | ๐ณ |

### ูฆ.ูข ูุนุงููุฑ ุงูุฃูุงู

| ุงููุนูุงุฑ | ุงููุตู | ุงูุญุงูุฉ |
|---------|-------|--------|
| **PCI-DSS** | ุจูุงูุงุช ุงูุจุทุงูุฉ ุชูุดูููุฑ ูู ุงููุชุตูุญุ ูุง ุชุตู ููุฎุงุฏู ุฃุจุฏุงู | โ ููุทุจููู |
| **Tokenization** | ุงุณุชุฎุฏุงู ุงูุชููู ุงูุขูู ุจุฏูุงู ูู ุฃุฑูุงู ุงูุจุทุงูุงุช | โ ููุทุจููู |
| **3D Secure** | ุฏุนู ูุงูู ููุชุญูู ุงูุซูุงุซู ูุน ุฅุนุงุฏุฉ ุงูุชูุฌูู | โ ููุทุจููู |
| **Server Verification** | ุงูุชุฃูุฏ ูู ุญุงูุฉ ุงูุฏูุน ูุจุงุดุฑุฉ ูู API ูููุตุงุฑ | โ ููุทุจููู |

### ูฆ.ูฃ ุชุฏูู ุงูุฏูุน

```
โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ
โ  ุฅุฏุฎุงู ุจูุงูุงุช  โ โ โ  Tokenization   โ โ โ  ุฅุฑุณุงู ููุฎุงุฏู  โ โ โ  ูููุตุงุฑ API    โ
โ  ุงูุจุทุงูุฉ       โ    โ  (ูู ุงููุชุตูุญ)   โ    โ  (token ููุท)   โ    โ  ูุนุงูุฌุฉ ุงูุฏูุน  โ
โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ
                                                                              โ
                                                                              โผ
โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ
โ  ุชูุนูู         โ โ โ  ุชุญูู ูู       โ โ โ  Callback      โ โ โ  3D Secure     โ
โ  ุงูุงุดุชุฑุงู      โ    โ  ุงูุฎุงุฏู        โ    โ  Redirect      โ    โ  (ุฅุฐุง ูุทููุจ)   โ
โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ
```

### ูฆ.ูค ุงููุชุบูุฑุงุช ุงูุจูุฆูุฉ ุงููุทููุจุฉ

| ุงููุชุบูุฑ | ุงููููุน | ุงููุตู |
|---------|--------|-------|
| `MOYASAR_SECRET_KEY` | ุงูุฎุงุฏู | ุงูููุชุงุญ ุงูุณุฑู ููุนุงูุฌุฉ ุงูุฏูุน |
| `VITE_MOYASAR_PUBLISHABLE_KEY` | ุงููุชุตูุญ | ุงูููุชุงุญ ุงูุนุงู ูู Tokenization |

### ูฆ.ูฅ ููุงุท ุงูุงุชุตุงู

| ุงููุณุงุฑ | ุงูุทุฑููุฉ | ุงููุตู |
|--------|---------|-------|
| `/api/payments` | POST | ุจุฏุก ุนูููุฉ ุงูุฏูุน |
| `/api/payments/callback` | GET | ุงุณุชูุจุงู ูุชูุฌุฉ 3D Secure |
| `/api/webhooks/moyasar` | POST | ุงุณุชูุจุงู ุฅุดุนุงุฑุงุช ูููุตุงุฑ |

**ุงูููููุงุช:**
- `client/src/components/moyasar-payment-form.tsx` - ูููุฐุฌ ุงูุฏูุน
- `server/moyasar.ts` - ุชูุงูู ุงูุฎุงุฏู ูุน ูููุตุงุฑ

---

## ูง. ูุฏุฑุงุช ุงูููุตุฉ ุงูุฃุณุงุณูุฉ

### ูง.ูก ูุญุฑู ุงูููุตูุงุช (REST Connector Engine)

**ุงูููู:** `server/connector-engine.ts`

#### ุฃููุงุน ุงููุตุงุฏูุฉ ุงููุฏุนููุฉ
| ุงูููุน | ุงููุตู |
|-------|-------|
| API Key | ููุชุงุญ ูู ุงูุฑุฃุณ ุฃู Query Parameter |
| Bearer Token | JWT ุฃู Access Token |
| OAuth2 | Client Credentials Flow |

#### ุงุณุชุฑุงุชูุฌูุงุช ุงูุชุฑููู (Pagination)
| ุงูุงุณุชุฑุงุชูุฌูุฉ | ุงููุตู |
|--------------|-------|
| Cursor | ูุคุดุฑ ููุตูุญุฉ ุงูุชุงููุฉ |
| Offset | ุฑูู ุงูุจุฏุงูุฉ ูุงูุญุฏ |
| Page Number | ุฑูู ุงูุตูุญุฉ |
| Time-Window | ูุทุงู ุฒููู |

#### ููุฒุงุช ุฅุถุงููุฉ
- ุชุญุฏูุฏ ูุนุฏู ุงูุทูุจุงุช (Token Bucket Algorithm)
- ูุญุต ุตุญุฉ ููุงุท ุงูุงุชุตุงู ุชููุงุฆูุงู
- ุงุณุชุฎุฑุงุฌ ุงูุจูุงูุงุช ุจู JSONPath

### ูง.ูข ูุญุฑู ุงูุฎุฑุงุฆุท (Mapping Engine)

**ุงูููู:** `server/mapping-engine.ts`

| ุงููุฏุฑุฉ | ุงููุตู |
|--------|-------|
| ุชุญูููุงุช JSONPath | ุชุญููู ุจูุงูุงุช REST ูููููุฐุฌ ุงูููุญุฏ |
| ุฅุตุฏุงุฑ ุงูุฎุฑุงุฆุท | ุชุชุจุน ูุชูุซูู ุฅุนุฏุงุฏุงุช ุงูุชุญููู |
| ุงูุชุดุงู ุงููุฏุฑุงุช | ูุญุต ููุงุท ุงูุงุชุตุงู ููุนุฑูุฉ ุงูุนูููุงุช ุงููุฏุนููุฉ |

#### ุงููููุฐุฌ ุงูููุญุฏ (Canonical Model)
```typescript
// Items - ุงูููุชุฌุงุช
{ id, sku, name, category, unitOfMeasure }

// Locations - ุงูููุงูุน
{ id, code, name, type, address }

// StockBalances - ุฃุฑุตุฏุฉ ุงููุฎุฒูู
{ itemId, locationId, quantity, reservedQty, availableQty }
```

### ูง.ูฃ ูุญุฑู ุงูุฐูุงุก ุงูุงุตุทูุงุนู (AI Engine)

**ุงูููู:** `server/ai-engine.ts`

| ุงููุฏุฑุฉ | ุงูุฎูุงุฑุฒููุฉ | ุงููุฎุฑุฌุงุช |
|--------|-----------|----------|
| **ุงูุชูุจุค ุจุงูุทูุจ** | ุงููุชูุณุท ุงููุชุญุฑู + ุชุญููู ุงูุงุชุฌุงู (7/14/30 ููู) | ูููุฉ ุงูุทูุจ ุงููุชููุนุฉ |
| **ุชููุน ููุงุฏ ุงููุฎุฒูู** | ุญุณุงุจ ุฃูุงู ุงูููุงุฏ | ุนุฏุฏ ุงูุฃูุงู + ุฏุฑุฌุฉ ุงูุซูุฉ |
| **ูุดู ุงูุญุงูุงุช ุงูุดุงุฐุฉ** | Z-score + ุงูุนุชุจุงุช | ููุน ุงูุดุฐูุฐ + ุงูุฎุทูุฑุฉ |

#### ุงูุฐูุงุก ุงููุงุจู ููุชูุณูุฑ (Explainable AI)
ูู ุชูุตูุฉ ุชุชุถูู:
```json
{
  "confidence_score": 0.87,
  "signals_used": ["demand_trend", "stock_level", "lead_time"],
  "explanation": "ุงููุฎุฒูู ุงูุญุงูู ูููู ูู 5 ุฃูุงู ููุท ุจูุงุกู ุนูู ูุนุฏู ุงูุทูุจ"
}
```

### ูง.ูค ูุธุงู ุงูุชูุตูุงุช ูุงูููุงููุงุช

#### ุฃููุงุน ุงูุชูุตูุงุช
| ุงูููุน | ุงููุตู | ุงูุฃููููุฉ |
|-------|-------|----------|
| `reorder` | ุฅุนุงุฏุฉ ุงูุทูุจ | ุนุงููุฉ |
| `transfer` | ููู ุจูู ุงูููุงูุน | ูุชูุณุทุฉ |
| `write_off` | ุดุทุจ | ููุฎูุถุฉ |
| `investigate` | ุชุญููู ูู ุดุฐูุฐ | ุญุณุจ ุงูุฎุทูุฑุฉ |

#### ุญุงูุงุช ุงูุชูุตูุฉ
```
pending โ approved โ (ready_for_execution) โ blocked_by_lock
          โ
       rejected
```

**ููุงุญุธุฉ ูููุฉ:** ุญุชู ุงูุชูุตูุงุช ุงููุนุชูุฏุฉ ูุง ุชูููููุฐ ุจุณุจุจ Execution Hard Lock.

### ูง.ูฅ ูุญุฑู ุงูุณูุงุณุงุช (Policy Engine)

**ุงูููู:** `server/policy-engine.ts`

| ุงููุฏุฑุฉ | ุงููุตู |
|--------|-------|
| **RBAC** | ุงูุชุญูู ุจุงููุตูู ุงููุจูู ุนูู ุงูุฃุฏูุงุฑ |
| **Tenant Isolation** | ุนุฒู ุงูุจูุงูุงุช ุจูู ุงููุณุชุฃุฌุฑูู |
| **Blast Radius Limits** | ููุน ุงูุฅุฌุฑุงุกุงุช ุงูุชู ุชุคุซุฑ ุนูู ุนูุงุตุฑ ูุซูุฑุฉ |
| **Dry-Run Requirement** | ุงูุฅุฌุฑุงุกุงุช ุงูุญุฑุฌุฉ ุชุชุทูุจ ุชุดุบูู ุชุฌุฑูุจู ุฃููุงู |
| **Approval Workflows** | ูุชุทูุจุงุช ููุงููุฉ ุญุณุจ ุงูุฃููููุฉ ูุงูุจูุฆุฉ |

#### ุงูุฃุฏูุงุฑ ุงููุชุงุญุฉ
| ุงูุฏูุฑ | ุงูุตูุงุญูุงุช |
|-------|-----------|
| `viewer` | ูุฑุงุกุฉ ููุท |
| `operator` | ูุฑุงุกุฉ + ููุงููุฉ ุนูู ุงูุชูุตูุงุช |
| `admin` | ูุงูู ุงูุตูุงุญูุงุช ุนูู ูุณุชูู ุงููุณุชุฃุฌุฑ |
| `platform_admin` | ุตูุงุญูุงุช ุงูููุตุฉ ุจุงููุงูู |

### ูง.ูฆ ุงูุณุฌู ุบูุฑ ุงููุงุจู ููุชุบููุฑ (Immutable Audit Trail)

**ุงููููุงุช:** `shared/schema.ts`, `server/storage.ts`

| ุงูุฎุงุตูุฉ | ุงููุตู |
|---------|-------|
| **Append-Only** | ูุง ูููู ุชุนุฏูู ุฃู ุญุฐู ุงูุณุฌูุงุช |
| **Sequence Numbers** | ุฃุฑูุงู ุชุณูุณููุฉ ููุชุฑุชูุจ ูุงูุณูุงูุฉ |
| **Correlation IDs** | ุชุชุจุน ุงูุฃุญุฏุงุซ ุงููุฑุชุจุทุฉ ุนุจุฑ ุณูุฑ ุงูุนูู |
| **Timestamps** | ุชูููุช ุฏููู ููู ุญุฏุซ |

#### ุฃููุงุน ุงูุฃุญุฏุงุซ
```typescript
type AuditEventType =
  | "signal_received"      // ุงุณุชูุจุงู ุฅุดุงุฑุฉ ูู ุงููุธุงู ุงูุฎุงุฑุฌู
  | "decision_generated"   // ุชูููุฏ ุชูุตูุฉ ุจุงูุฐูุงุก ุงูุงุตุทูุงุนู
  | "policy_evaluated"     // ุชูููู ุณูุงุณุฉ
  | "approval_requested"   // ุทูุจ ููุงููุฉ
  | "approval_resolved"    // ุญู ุทูุจ ุงูููุงููุฉ
  | "action_executed"      // ุชูููุฐ ุฅุฌุฑุงุก (ูููู ุฏุงุฆูุงู)
  | "action_blocked"       // ุญุธุฑ ุฅุฌุฑุงุก ุจูุงุณุทุฉ ุงูููู
```

---

## ูจ. ุนูุงุตุฑ ุงูุฃูุงู

### ูจ.ูก ููู ุงูุชูููุฐ ุงูุตุงุฑู (Execution Hard Lock)

**ุงูููู:** `server/execution-lock.ts`

> **ุงููุธุงู ูุตูู ุจุญูุซ ูุณุชุญูู ุชูููุฐ ุฃู ุฅุฌุฑุงุก ุชููุงุฆู ุนูู ุงูุฃูุธูุฉ ุงูุฎุงุฑุฌูุฉ**

| ุงูุฎุงุตูุฉ | ุงููุตู |
|---------|-------|
| **DRAFT_ONLY Mode** | ุงูููุตุฉ ูุจุฑูุฌุฉ ุนูู ุนุฏู ุงูุชูููุฐ ุฃุจุฏุงู |
| **By Design** | ุงูุชูููุฐ ูุณุชุญููุ ููุณ ูุนุทูุงู ููุท |
| **API Level Blocking** | ุญุชู ูู ุชู ุชุฌุงูุฒ ุงููุงุฌูุฉุ ุงูุฎุงุฏู ูุฑูุถ |
| **Audit Trail** | ุฌููุน ูุญุงููุงุช ุงูุชูููุฐ ุชูุณุฌููู |

#### ูุง ูููู ููููุตุฉ ูุนูู โ
- ุชูููุฏ ุชูุตูุงุช ุฐูุงุก ุงุตุทูุงุนู
- ุฅูุดุงุก/ุชุญุฏูุซ ุงูุณุฌูุงุช ุงูุฏุงุฎููุฉ (ุชูุตูุงุชุ ุณูุงุณุงุชุ ุฎุฑุงุฆุท)
- ุณูุฑ ุนูู ุงูููุงููุฉ ุงูุจุดุฑูุฉ
- ุฅุนุฏุงุฏ ุงูููุตูุงุช ูุงูุฎุฑุงุฆุท
- ูุฑุงุกุฉ ุงูุจูุงูุงุช ูู ุงูุฃูุธูุฉ ุงูุฎุงุฑุฌูุฉ

#### ูุง ูุง ูููู ููููุตุฉ ูุนูู โ
- ุชูููุฐ ุฅุฌุฑุงุกุงุช ุชูุชุจ ูู ุงูุฃูุธูุฉ ุงูุฎุงุฑุฌูุฉ
- ุงูุชุทุจูู ุงูุชููุงุฆู ููุชูุตูุงุช
- ุชุฌุงูุฒ ููู ุงูุชูููุฐ ุจุฃู ูุณููุฉ

### ูจ.ูข ุงููุตุงุฏูุฉ (Authentication)

| ุงูุนูุตุฑ | ุงูุชูุงุตูู |
|--------|----------|
| **ุงููุฒูุฏ** | Replit Auth (OIDC) |
| **ุงูุทุฑู ุงููุฏุนููุฉ** | Googleุ GitHubุ ุงูุจุฑูุฏ ุงูุฅููุชุฑููู |
| **ุชุฎุฒูู ุงูุฌูุณุงุช** | PostgreSQL ุนุจุฑ connect-pg-simple |
| **ุงูุชุฒููุฏ ุงูุชููุงุฆู** | ุงููุณุชุฎุฏููู ุงูุฌุฏุฏ ูุญุตููู ุนูู ูุณุชุฃุฌุฑ ูุฏูุฑ admin ุชููุงุฆูุงู |

#### ุจููุฉ ุงูุฌุฏุงูู
```typescript
// auth_identities - ูููุงุช OIDC
{ sub, email, firstName, lastName, profileImage }

// users - ุงููุณุชุฎุฏููู
{ id, tenantId, authIdentityId, role, platformRole }
```

### ูจ.ูฃ ุงูุนุฒู ูุชุนุฏุฏ ุงููุณุชุฃุฌุฑูู (Multi-Tenant Isolation)

| ุงููุงุนุฏุฉ | ุงูุชุทุจูู |
|---------|---------|
| ูู ุทูุจ API ูุชุญูู ูู tenantId | โ |
| ูุง ูููู ุงููุตูู ูุจูุงูุงุช ูุณุชุฃุฌุฑ ุขุฎุฑ | โ |
| ุงูุงุณุชุนูุงูุงุช ุชูููุชุฑ ุจู tenantId ุชููุงุฆูุงู | โ |
| Platform Admin ููููู ุฑุคูุฉ ุฌููุน ุงููุณุชุฃุฌุฑูู | โ |

---

## ูฉ. ุงูุชุฏููู (Internationalization)

### ูฉ.ูก ุงููุบุงุช ุงููุฏุนููุฉ

| ุงููุบุฉ | ุงูุงุชุฌุงู | ุงูุญุงูุฉ |
|-------|---------|--------|
| ุงูุนุฑุจูุฉ | RTL | ุงูุชุฑุงุถูุฉ |
| ุงูุฅูุฌููุฒูุฉ | LTR | ูุชุงุญุฉ |

### ูฉ.ูข ูุธุงู ุงูุฎุทูุท

| ููุน ุงูุฎุท | ุงูุงุณู | ุงูุงุณุชุฎุฏุงู |
|----------|-------|-----------|
| ุงูุนูุงููู | Tajawal | ุงูุนูุงููู ูุงูุดุนุงุฑุงุช |
| ุงููุตูุต | IBM Plex Sans Arabic | ุงููุตูุต ุงููุธูููุฉ ูุงููุงุฌูุฉ |
| ุงูุฃุฑูุงู | Inter | ุงูุฃุฑูุงู ุจุชูุณูู tabular-nums |

### ูฉ.ูฃ ุขููุฉ ุงูุชุจุฏูู

- ุฒุฑ ุชุจุฏูู ุงููุบุฉ ูู ุฑุฃุณ ุงูุตูุญุฉ
- ุงูุชุจุฏูู ููุฑู ุจุฏูู ุฅุนุงุฏุฉ ุชุญููู
- ููุญูุธ ุงุฎุชูุงุฑ ุงููุณุชุฎุฏู ูู localStorage

**ุงูููู:** `client/src/lib/translations.ts`

---

## ูกู. ุงูุจููุฉ ุงูุชูููุฉ

### ูกู.ูก ุงููุงุฌูุฉ ุงูุฃูุงููุฉ (Frontend)

| ุงูุชูููุฉ | ุงูุงุณุชุฎุฏุงู |
|---------|-----------|
| React 18 | ุฅุทุงุฑ ุงูุนูู ุงูุฑุฆูุณู |
| TypeScript | ูุบุฉ ุงูุจุฑูุฌุฉ |
| Vite | ุฃุฏุงุฉ ุงูุจูุงุก |
| Wouter | ุงูุชูุฌูู |
| TanStack Query | ุฅุฏุงุฑุฉ ุญุงูุฉ ุงูุฎุงุฏู |
| Tailwind CSS | ุงูุชุตููู |
| shadcn/ui + Radix | ููููุงุช ุงููุงุฌูุฉ |

### ูกู.ูข ุงูุฎุงุฏู (Backend)

| ุงูุชูููุฉ | ุงูุงุณุชุฎุฏุงู |
|---------|-----------|
| Node.js | ุจูุฆุฉ ุงูุชุดุบูู |
| Express | ุฅุทุงุฑ ุงูุนูู |
| TypeScript (ESM) | ูุบุฉ ุงูุจุฑูุฌุฉ |
| Drizzle ORM | ุงูุชุนุงูู ูุน ูุงุนุฏุฉ ุงูุจูุงูุงุช |
| PostgreSQL | ูุงุนุฏุฉ ุงูุจูุงูุงุช |

### ูกู.ูฃ ูููู ุงููุดุฑูุน

```
โโโ client/               # ุชุทุจูู React
โ   โโโ src/
โ       โโโ components/   # ููููุงุช ูุงุจูุฉ ูุฅุนุงุฏุฉ ุงูุงุณุชุฎุฏุงู
โ       โโโ pages/        # ุตูุญุงุช ุงูุชุทุจูู
โ       โโโ hooks/        # React Hooks ูุฎุตุตุฉ
โ       โโโ lib/          # ุฃุฏูุงุช ููุณุงุนุฏุงุช
โโโ server/               # ุฎุงุฏู Express
โ   โโโ index.ts          # ููุทุฉ ุงูุฏุฎูู
โ   โโโ routes.ts         # ุชุนุฑูู ุงููุณุงุฑุงุช
โ   โโโ storage.ts        # ุทุจูุฉ ุงููุตูู ููุจูุงูุงุช
โ   โโโ ai-engine.ts      # ูุญุฑู ุงูุฐูุงุก ุงูุงุตุทูุงุนู
โ   โโโ connector-engine.ts # ูุญุฑู ุงูููุตูุงุช
โ   โโโ mapping-engine.ts # ูุญุฑู ุงูุฎุฑุงุฆุท
โ   โโโ policy-engine.ts  # ูุญุฑู ุงูุณูุงุณุงุช
โ   โโโ execution-lock.ts # ููู ุงูุชูููุฐ
โ   โโโ moyasar.ts        # ุชูุงูู ูููุตุงุฑ
โโโ shared/               # ููุฏ ูุดุชุฑู
โ   โโโ schema.ts         # ูุฎุทุท ูุงุนุฏุฉ ุงูุจูุงูุงุช
โโโ migrations/           # ุชุฑุญููุงุช ูุงุนุฏุฉ ุงูุจูุงูุงุช
```

---

## ูกูก. ุงููููุงุช ุงูุฑุฆูุณูุฉ

### ูกูก.ูก ููููุงุช ุงููุงุฌูุฉ

| ุงูููู | ุงููุตู |
|-------|-------|
| `client/src/components/trial-banner.tsx` | ูุงูุชุฉ ุงูุนุฏ ุงูุชูุงุฒูู |
| `client/src/components/trial-expired-screen.tsx` | ุดุงุดุฉ ุงูุชูุงุก ุงููุชุฑุฉ |
| `client/src/components/moyasar-payment-form.tsx` | ูููุฐุฌ ุงูุฏูุน |
| `client/src/pages/subscription.tsx` | ุตูุญุฉ ุฅุฏุงุฑุฉ ุงูุงุดุชุฑุงู |
| `client/src/pages/landing.tsx` | ุงูุตูุญุฉ ุงูุฑุฆูุณูุฉ ุงูุชุณููููุฉ |
| `client/src/pages/dashboard.tsx` | ููุญุฉ ุงูุชุญูู |
| `client/src/pages/onboarding.tsx` | ูุนุงูุฌ ุงูุฅุนุฏุงุฏ |

### ูกูก.ูข ุฎุฏูุงุช ุงูุฎุงุฏู

| ุงูููู | ุงููุตู |
|-------|-------|
| `server/ai-engine.ts` | ูุญุฑู ุงูุฐูุงุก ุงูุงุตุทูุงุนู |
| `server/connector-engine.ts` | ูุญุฑู ุงูููุตูุงุช |
| `server/mapping-engine.ts` | ูุญุฑู ุงูุฎุฑุงุฆุท |
| `server/policy-engine.ts` | ูุญุฑู ุงูุณูุงุณุงุช |
| `server/execution-lock.ts` | ููู ุงูุชูููุฐ |
| `server/moyasar.ts` | ุชูุงูู ูููุตุงุฑ |
| `server/routes.ts` | ุฌููุน ูุณุงุฑุงุช API |

### ูกูก.ูฃ ุงููุดุชุฑู

| ุงูููู | ุงููุตู |
|-------|-------|
| `shared/schema.ts` | ูุฎุทุท ูุงุนุฏุฉ ุงูุจูุงูุงุช (Drizzle) |

---

## ูกูข. ููุงุท ุงูุงุชุตุงู (API Endpoints)

### ูกูข.ูก ุงููุตุงุฏูุฉ
| ุงููุณุงุฑ | ุงูุทุฑููุฉ | ุงููุตู |
|--------|---------|-------|
| `/api/auth/user` | GET | ูุนูููุงุช ุงููุณุชุฎุฏู ุงูุญุงูู |
| `/api/login` | GET | ุจุฏุก ุชุณุฌูู ุงูุฏุฎูู |
| `/api/logout` | POST | ุชุณุฌูู ุงูุฎุฑูุฌ |

### ูกูข.ูข ุงูุฅุนุฏุงุฏ
| ุงููุณุงุฑ | ุงูุทุฑููุฉ | ุงููุตู |
|--------|---------|-------|
| `/api/onboarding/status` | GET | ุญุงูุฉ ุงูุฅุนุฏุงุฏ ุงูุญุงููุฉ |
| `/api/onboarding/complete` | POST | ุฅููุงู ุงูุฅุนุฏุงุฏ |

### ูกูข.ูฃ ุงูุงุดุชุฑุงูุงุช ูุงููุฏููุนุงุช
| ุงููุณุงุฑ | ุงูุทุฑููุฉ | ุงููุตู |
|--------|---------|-------|
| `/api/subscription-plans` | GET | ุงูุฎุทุท ุงููุชุงุญุฉ |
| `/api/subscriptions` | GET | ุงุดุชุฑุงู ุงููุณุชุฃุฌุฑ |
| `/api/payments` | POST | ุจุฏุก ุนูููุฉ ุฏูุน |
| `/api/payments/callback` | GET | ุงุณุชูุจุงู ูุชูุฌุฉ 3D Secure |

### ูกูข.ูค ุงูููุตูุงุช ูุงูุฎุฑุงุฆุท
| ุงููุณุงุฑ | ุงูุทุฑููุฉ | ุงููุตู |
|--------|---------|-------|
| `/api/connectors` | GET/POST | ุฅุฏุงุฑุฉ ุงูููุตูุงุช |
| `/api/connectors/:id` | GET/PATCH/DELETE | ููุตู ูุญุฏุฏ |
| `/api/mappings` | GET/POST | ุฅุฏุงุฑุฉ ุงูุฎุฑุงุฆุท |

### ูกูข.ูฅ ุงูุฐูุงุก ุงูุงุตุทูุงุนู
| ุงููุณุงุฑ | ุงูุทุฑููุฉ | ุงููุตู |
|--------|---------|-------|
| `/api/recommendations` | GET/POST | ุงูุชูุตูุงุช |
| `/api/recommendations/:id/approve` | POST | ุงูููุงููุฉ ุนูู ุชูุตูุฉ |
| `/api/recommendations/:id/reject` | POST | ุฑูุถ ุชูุตูุฉ |
| `/api/anomalies` | GET | ุงูุญุงูุงุช ุงูุดุงุฐุฉ |

### ูกูข.ูฆ ุงูุญูููุฉ
| ุงููุณุงุฑ | ุงูุทุฑููุฉ | ุงููุตู |
|--------|---------|-------|
| `/api/policies` | GET/POST | ุงูุณูุงุณุงุช |
| `/api/audit-logs` | GET | ุณุฌู ุงูุชุฏููู |
| `/api/approvals` | GET | ุทูุจุงุช ุงูููุงููุฉ |

---

## ูกูฃ. ุงูุจูุฆุฉ ุงูุชุฌุฑูุจูุฉ (Demo)

### ูกูฃ.ูก ุจุฏุก ุงูุชุดุบูู
```bash
./scripts/start-demo.sh
```

### ูกูฃ.ูข ุณููุงุฑูููุงุช ุงูุนุฑุถ

| ุงูุณููุงุฑูู | ุงููุตู | ุงูุนูุงุตุฑ |
|-----------|-------|---------|
| ููุงุฏ ูุดูู | ูุฎุฒูู ููุฎูุถ ุฌุฏุงู | Items 1-5 |
| ุงุฑุชูุงุน ููุงุฌุฆ | ุฒูุงุฏุฉ ุบูุฑ ุทุจูุนูุฉ ูู ุงูุทูุจ | Items 6-10 |
| ูุฎุฒูู ุฑุงูุฏ | ูุฎุฒูู ุนุงูู ุจุญุฑูุฉ ููููุฉ | Items 61-65 |
| ุญุฑูุฉ ุดุงุฐุฉ | ูุนุงููุงุช ูุจูุฑุฉ ุบูุฑ ุทุจูุนูุฉ | Items 11-15 |

### ูกูฃ.ูฃ ุงููุธุงู ุงูุฎุงุฑุฌู ุงููููู
- **ุงููููุฐ**: 3001
- **ุงููุตุงุฏูุฉ**: API Key ุนุจุฑ `X-API-Key`
- **ุงูููุงุชูุญ ุงูุตุงูุญุฉ**: `DEMO-API-KEY-2024`, `ENTERPRISE-KEY-001`

---

## ูกูค. ุงูุฎุทูุงุช ุงููุงุฏูุฉ (Roadmap)

| ุงูุฃููููุฉ | ุงูููุฒุฉ | ุงููุตู | ุงูุญุงูุฉ |
|----------|--------|-------|--------|
| ๐ด ุนุงููุฉ | ุงุฎุชุจุงุฑุงุช ุงูุชูุงูู | ุงุฎุชุจุงุฑุงุช ุขููุฉ ูุชุฏููุงุช 3D Secure | ูุฎุทุท |
| ๐ด ุนุงููุฉ | ุฅุดุนุงุฑุงุช ุงูุจุฑูุฏ | ุชูุจููุงุช ุชุฌุฏูุฏ ุงูุงุดุชุฑุงู | ูุฎุทุท |
| ๐ก ูุชูุณุทุฉ | ุชูุงุฑูุฑ ูุชูุฏูุฉ | ููุญุงุช ุชุญููููุฉ ูููุฎุฒูู | ูุฎุทุท |
| ๐ก ูุชูุณุทุฉ | ุชูุงููุงุช ERP | SAP, Oracle, Microsoft Dynamics | ูุฎุทุท |
| ๐ข ููุฎูุถุฉ | ุชุทุจูู ุงูุฌูุงู | ูุงุฌูุฉ ูุชูุงููุฉ ูุน ุงูููุงุชู | ูุฎุทุท |
| ๐ข ููุฎูุถุฉ | AI ุงููุญุงุฏุซุฉ | ูุณุงุนุฏ ุฐูู ููุงุณุชูุณุงุฑุงุช | ูุฎุทุท |

---

## ูกูฅ. ูุนูููุงุช ุงูุฅุตุฏุงุฑ

| ุงูุนูุตุฑ | ุงููููุฉ |
|--------|--------|
| **ุชุงุฑูุฎ ุงูุฅุตุฏุงุฑ** | ููุงูุฑ 2026 |
| **ุฑูู ุงูุฅุตุฏุงุฑ** | 1.0.0 |
| **ุงูุญุงูุฉ** | ุฌุงูุฒ ููุฅูุชุงุฌ |
| **ุงููุณุคูู** | ูุฑูู ุชุทููุฑ Atlas |

---

## ููุญู ุฃ: ูุงููุณ ุงููุตุทูุญุงุช

| ุงููุตุทูุญ | ุงูุชุฑุฌูุฉ | ุงูุชุนุฑูู |
|---------|---------|---------|
| Tenant | ุงููุณุชุฃุฌุฑ | ููุงู ุงูุนููู ุงููุนุฒูู |
| Connector | ุงูููุตู | ุชูููู ุงูุงุชุตุงู ุจู API ุฎุงุฑุฌู |
| Mapping | ุงูุฎุฑูุทุฉ | ููุงุนุฏ ุชุญููู ุงูุจูุงูุงุช |
| Recommendation | ุงูุชูุตูุฉ | ุงูุชุฑุงุญ ูู ุงูุฐูุงุก ุงูุงุตุทูุงุนู |
| Anomaly | ุงูุญุงูุฉ ุงูุดุงุฐุฉ | ุจูุงูุงุช ุบูุฑ ุทุจูุนูุฉ ููุชุดูุฉ |
| Policy | ุงูุณูุงุณุฉ | ูุงุนุฏุฉ ุญูููุฉ |
| Audit Log | ุณุฌู ุงูุชุฏููู | ุณุฌู ุงูุฃุญุฏุงุซ ุบูุฑ ุงููุงุจู ููุชุบููุฑ |
| Approval | ุงูููุงููุฉ | ูุฑุงุฑ ุจุดุฑู ุนูู ุชูุตูุฉ |
| Execution Lock | ููู ุงูุชูููุฐ | ุขููุฉ ููุน ุงูุชูููุฐ ุงูุชููุงุฆู |

---

**ููุงูุฉ ุงููุซููุฉ**
